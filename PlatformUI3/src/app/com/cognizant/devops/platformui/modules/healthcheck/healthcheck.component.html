<!--
*******************************************************************************
 * Copyright 2017 Cognizant Technology Solutions
 * 
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License.  You may obtain a copy
 * of the License at
 * 
 *   http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations under
 * the License.
 ****************************************************************************** -->

<div layout layout-align="left" class="titleStyle">
  <div  id="healthCheckTitle">Health Check | 
      <a  (click)="goToSection('agentsTable')"> Agents</a> |
      <a  (click)="goToSection('dataComponentTable')"> Data Components</a> |
      <a  (click)="goToSection('servicesTable')"> Services</a>
  </div>
</div>

<div class="orangeStripCss"></div>

<div layout layout-align="left" class="sectionHeadingStyle">
  <div layout>Insights Agents</div>
</div>

<div id="agentsTable" layout-align="center center" class="tableContainerStyle">
  <!-- Insights Agents Table -->
  <table mat-table [dataSource]="dataSource" >
    <!-- Category Column -->
    <ng-container matColumnDef="category">
      <th mat-header-cell *matHeaderCellDef class="tableHeaderCss"> Category </th>
      <td mat-cell *matCellDef="let element" style="width:200px !important"> {{element.propertyMap.category}} </td>
    </ng-container>
    <!-- Tool Column -->
    <ng-container matColumnDef="toolName">
      <th mat-header-cell *matHeaderCellDef class="tableHeaderCss"> Tool </th>
      <td mat-cell *matCellDef="let element" > {{element.propertyMap.toolName}} </td>
    </ng-container>
    <!-- Time Column -->
    <ng-container matColumnDef="inSightsTimeX">
      <th mat-header-cell *matHeaderCellDef class="tableHeaderCss"> Time </th>
      <td mat-cell *matCellDef="let element" > {{element.propertyMap.inSightsTimeX}} </td>
    </ng-container>
    <!-- Status Column -->
    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef class="tableHeaderCss"> Status </th>
      <td mat-cell *matCellDef="let element" >
        <mat-icon svgIcon="healthcheck_success_status" *ngIf="element.propertyMap.status =='success'" [ngStyle]="{color: '#00B140', height: '25px', width: '25px'}">
        </mat-icon>
        <mat-icon svgIcon="healthcheck_failure_status" *ngIf="element.propertyMap.status =='failure'" [ngStyle]="{color: '#FF8F1C', height: '25px', width: '25px'}">
        </mat-icon>
      </td>
    </ng-container>
    <!-- Details Column -->
    <ng-container matColumnDef="details">
      <th mat-header-cell *matHeaderCellDef class="tableHeaderCss"> Details </th>
      <td mat-cell *matCellDef="let element" >
        <button (click)="showDetailsDialog(element.propertyMap.toolName,element.propertyMap.category)">
          <mat-icon svgIcon="healthcheck_show_details" [ngStyle]="{height: '25px', width: '25px'}">
          </mat-icon>
        </button>
      </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="displayedColumns" class="tableHeaderCss"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
</div>
<div layout layout-align="right" class="rightAlignStyle">
  <button class="backToTopButtonStyle" (click)="goToHealthCheckTitle()">Back to Top</button>
</div>

<div layout layout-align="left" class="sectionHeadingStyle">
  <div layout>Data Components</div>
</div>

<div id="dataComponentTable" layout-align="center center" class="tableContainerStyle">
  <table mat-table [dataSource]="dataComponentDataSource">
    <!-- Server Column -->
    <ng-container matColumnDef="serverName">
      <th mat-header-cell *matHeaderCellDef class="tableHeaderCss">Server</th>
      <td mat-cell *matCellDef="let key" style="width:200px !important"> {{key.serverName}} </td>
    </ng-container>

    <!-- IP Address:Port Column -->
    <ng-container matColumnDef="ipAddress">
      <th mat-header-cell *matHeaderCellDef class="tableHeaderCss">IP Address:Port</th>
      <td mat-cell *matCellDef="let key" > {{key.endPoint}} </td>
    </ng-container>

    <!-- Version Column -->
    <ng-container matColumnDef="version">
      <th mat-header-cell *matHeaderCellDef class="tableHeaderCss">Version</th>
      <td mat-cell *matCellDef="let key" > {{key.version}} </td>
    </ng-container>

    <!-- Status Column -->
    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef class="tableHeaderCss">Status</th>
      <td mat-cell *matCellDef="let key" >
        <mat-icon svgIcon="healthcheck_success_status" *ngIf="key.status =='success'" [ngStyle]="{color: '#00B140', height: '25px', width: '25px'}">
        </mat-icon>
        <mat-icon svgIcon="healthcheck_failure_status" *ngIf="key.status =='failure'" [ngStyle]="{color: '#FF8F1C', height: '25px', width: '25px'}">
        </mat-icon>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="dataComponentColumns" class="tableHeaderCss"></tr>
    <tr mat-row *matRowDef="let row; columns: dataComponentColumns;"></tr>
  </table>
</div>

<div layout layout-align="right" class="rightAlignStyle">
  <button class="backToTopButtonStyle" (click)="goToHealthCheckTitle()">Back to Top</button>
</div>

<div layout layout-align="left" class="sectionHeadingStyle">
  <div layout>Services</div>
</div>

<div id="servicesTable" layout-align="center center" class="tableContainerStyle">
  <table mat-table [dataSource]="servicesDataSource" *ngIf="showContent">
    <!-- Server Column -->
    <ng-container matColumnDef="serverName">
      <th mat-header-cell *matHeaderCellDef class="tableHeaderCss">Server</th>
      <td mat-cell *matCellDef="let key" style="width:200px !important"> {{key.serverName}} </td>
    </ng-container>
    <!-- IP Address:Port Column -->
    <ng-container matColumnDef="ipAddress">
      <th mat-header-cell *matHeaderCellDef class="tableHeaderCss">IP Address:Port</th>
      <td mat-cell *matCellDef="let key"> {{key.endPoint}} </td>
    </ng-container>
    <!-- Version Column -->
    <ng-container matColumnDef="version" class="tableHeaderCss">
      <th mat-header-cell *matHeaderCellDef class="tableHeaderCss">Version</th>
      <td mat-cell *matCellDef="let key"> {{key.version}} </td>
    </ng-container>
    <!-- Status Column -->
    <ng-container matColumnDef="status" class="tableHeaderCss">
      <th mat-header-cell *matHeaderCellDef class="tableHeaderCss">Status</th>
      <td mat-cell *matCellDef="let key">
        <mat-icon svgIcon="healthcheck_success_status" *ngIf="key.status =='success'" [ngStyle]="{color: '#00B140', height: '25px', width: '25px'}">
        </mat-icon>
        <mat-icon svgIcon="healthcheck_failure_status" *ngIf="key.status =='failure'" [ngStyle]="{color: '#FF8F1C', height: '25px', width: '25px'}">
        </mat-icon>
      </td>
    </ng-container>
    <!-- Details Column -->
    <ng-container matColumnDef="details">
      <th mat-header-cell *matHeaderCellDef class="tableHeaderCss">Details</th>
      <td mat-cell *matCellDef="let key">
        <button (click)="showDetailsDialog('-',key.serverName)">
          <mat-icon svgIcon="healthcheck_show_details" [ngStyle]="{height: '25px', width: '25px'}">
          </mat-icon>
        </button>
      </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="serverColumns" class="tableHeaderCss"></tr>
    <tr mat-row *matRowDef="let row; columns: serverColumns;"></tr>
  </table>
  <div *ngIf="showThrobber">   
      <mat-progress-spinner
                  [color]="primary"
                  [mode]="indeterminate"
                  style="display:inline;"
                  [value]="30">
      </mat-progress-spinner>
  </div>
  <div *ngIf="!showContent" >
      <mat-icon svgIcon="healthcheck_failure_status" [ngStyle]="{color: '#FF8F1C', height: '25px', width: '25px'}">
      </mat-icon>
         Service Failure. Please try again.
  </div>  
</div>
<div layout layout-align="right" class="rightAlignStyle">
  <button class="backToTopButtonStyle" (click)="goToHealthCheckTitle()">Back to Top</button>
</div>